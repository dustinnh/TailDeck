# TailDeck Environment Variables
# Copy this file to .env.local and fill in the values
# NEVER commit .env.local or any file with actual secrets

# ============================================
# DATABASE (PostgreSQL)
# ============================================
DATABASE_URL="postgresql://taildeck:taildeck_dev@localhost:5432/taildeck"

# ============================================
# AUTH.JS CONFIGURATION
# ============================================
# Generate with: openssl rand -base64 32
# MUST be at least 32 characters
AUTH_SECRET="generate-a-secret-with-openssl-rand-base64-32"

# IMPORTANT: This must be the EXTERNAL URL that users access in their browser
# For production with HTTPS: AUTH_URL="https://taildeck.yourdomain.com"
AUTH_URL="http://localhost:3000"

# ============================================
# AUTHENTIK OIDC PROVIDER
# Configure in Authentik Admin > Applications > Providers
# Or let setup.sh auto-configure with the bootstrap token
# ============================================
AUTH_AUTHENTIK_ID="taildeck"
AUTH_AUTHENTIK_SECRET="your-authentik-client-secret"

# IMPORTANT: This must be the EXTERNAL URL that users access in their browser
# The browser redirects to Authentik for login, so it needs external access
# For production: AUTH_AUTHENTIK_ISSUER="https://auth.yourdomain.com/application/o/taildeck/"
AUTH_AUTHENTIK_ISSUER="http://localhost:9000/application/o/taildeck/"

# ============================================
# AUTHENTIK BOOTSTRAP (for auto-configuration)
# Used by setup.sh to auto-configure Authentik OAuth2 provider
# The setup script will auto-generate this token if empty
# ============================================
AUTHENTIK_BOOTSTRAP_TOKEN=""
AUTHENTIK_URL="http://localhost:9000"

# ============================================
# HEADSCALE CONNECTION
# These are SERVER-ONLY - NEVER use NEXT_PUBLIC_ prefix
# ============================================
HEADSCALE_URL="http://localhost:8080"
# Generate with: docker exec headscale headscale apikeys create
HEADSCALE_API_KEY="your-headscale-api-key"
# Metrics endpoint (Prometheus format) - port 9090 by default
HEADSCALE_METRICS_URL="http://localhost:9090/metrics"

# ============================================
# OPTIONAL: FLOW LOGS (Loki)
# ============================================
# LOKI_URL="http://localhost:3100"
# LOKI_TENANT_ID=""
# LOKI_USERNAME=""
# LOKI_PASSWORD=""

# ============================================
# OPTIONAL: LOGGING
# ============================================
LOG_LEVEL="info"
# Options: trace, debug, info, warn, error, fatal

# ============================================
# DOMAIN CONFIGURATION (for Caddy reverse proxy)
# Required for production deployments with HTTPS
# ============================================
# Set these to your actual domain names
# TAILDECK_DOMAIN="taildeck.yourdomain.com"
# AUTHENTIK_DOMAIN="auth.yourdomain.com"
# HEADSCALE_DOMAIN="headscale.yourdomain.com"

# ============================================
# PORT CONFIGURATION (for avoiding conflicts)
# ============================================
# Uncomment and change any ports that conflict with existing services.
# All ports have sensible defaults - only configure what you need to change.

# TailDeck application port (when using --profile app)
# TAILDECK_PORT=3000

# Authentik OIDC provider ports
# AUTHENTIK_HTTP_PORT=9000
# AUTHENTIK_HTTPS_PORT=9443

# Headscale VPN coordinator ports
# HEADSCALE_API_PORT=8080
# HEADSCALE_METRICS_PORT=9090

# NetFlow/sFlow/IPFIX collector ports (UDP)
# NETFLOW_PORT=2055
# SFLOW_PORT=6343
# IPFIX_PORT=4739

# Note: PostgreSQL (5432) is hardcoded for development convenience.
# For production, consider not exposing it to the host.
